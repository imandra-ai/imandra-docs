<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Fut (imandra-base.Imandra_thread_util.Fut)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">imandra-base</a> &#x00BB; <a href="../index.html">Imandra_thread_util</a> &#x00BB; Fut</nav><header class="odoc-preamble"><h1>Module <code><span>Imandra_thread_util.Fut</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#concurrent-futures">Concurrent Futures</a></li></ul></nav><div class="odoc-content"><h2 id="concurrent-futures"><a href="#concurrent-futures" class="anchor"></a>Concurrent Futures</h2><p>Our notion of concurrency is organized around <code>'aFut</code>.t, which is a value that will resolve into a <code>'a</code> in the future. This is (mostly) monadic and applicative, and the use of &quot;let operators&quot; should make it reasonably ergonomic.</p><p>The notion of <code>'aFut</code>.t is shared, but most combinators are in the functor <a href="Make/index.html"><code>Fut.Make</code></a> which depends on an executor (to specify where the combinator code runs).</p><div class="odoc-spec"><div class="spec type" id="type-backtrace" class="anchored"><a href="#type-backtrace" class="anchor"></a><code><span><span class="keyword">type</span> backtrace</span><span> = <span class="xref-unresolved">Stdlib</span>.Printexc.raw_backtrace</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-exn_with_bt_opt" class="anchored"><a href="#type-exn_with_bt_opt" class="anchor"></a><code><span><span class="keyword">type</span> exn_with_bt_opt</span><span> = exn * <span><a href="#type-backtrace">backtrace</a> option</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-listener" class="anchored"><a href="#type-listener" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a listener</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-fut_state" class="anchored"><a href="#type-fut_state" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a fut_state</span></span><span> = <span class="keyword">private</span> </span></code><table><tr id="type-fut_state.Fut_wait" class="anchored"><td class="def variant constructor"><a href="#type-fut_state.Fut_wait" class="anchor"></a><code><span>| </span><span><span class="constructor">Fut_wait</span> <span class="keyword">of</span> </span><span>{</span></code><table><tr id="type-fut_state.listen" class="anchored"><td class="def record field"><a href="#type-fut_state.listen" class="anchor"></a><code><span><span class="keyword">mutable</span> listen : <span><span><span class="type-var">'a</span> <a href="#type-listener">listener</a></span> list</span>;</span></code></td></tr></table><code><span>}</span></code></td></tr><tr id="type-fut_state.Fut_done" class="anchored"><td class="def variant constructor"><a href="#type-fut_state.Fut_done" class="anchor"></a><code><span>| </span><span><span class="constructor">Fut_done</span> <span class="keyword">of</span> <span class="type-var">'a</span></span></code></td></tr><tr id="type-fut_state.Fut_exn" class="anchored"><td class="def variant constructor"><a href="#type-fut_state.Fut_exn" class="anchor"></a><code><span>| </span><span><span class="constructor">Fut_exn</span> <span class="keyword">of</span> exn * <span><a href="#type-backtrace">backtrace</a> option</span></span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-S0" class="anchored"><a href="#module-type-S0" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-S0/index.html">S0</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="module-type-S0/index.html">S0</a></span></code></summary><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span></code></div><div class="spec-doc"><p>The type of futures values of type <code>'a</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp" class="anchored"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><span><span class="type-var">'a</span> <span class="xref-unresolved">CCFormat</span>.printer</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="xref-unresolved">CCFormat</span>.printer</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-state" class="anchored"><a href="#val-state" class="anchor"></a><code><span><span class="keyword">val</span> state : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-fut_state">fut_state</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-is_done" class="anchored"><a href="#val-is_done" class="anchor"></a><code><span><span class="keyword">val</span> is_done : <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_done fut</code> is <code>true</code> iff <code>state fut</code> is not <code>Fut_wait</code>. In other words, the future has resolved to a value or an exception.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-return" class="anchored"><a href="#val-return" class="anchor"></a><code><span><span class="keyword">val</span> return : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Future that just contains a value</p></div></div><div class="odoc-spec"><div class="spec value" id="val-fail" class="anchored"><a href="#val-fail" class="anchor"></a><code><span><span class="keyword">val</span> fail : <span>exn <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Future that just contains a failure</p></div></div><div class="odoc-spec"><div class="spec value" id="val-fail_with_backtrace" class="anchored"><a href="#val-fail_with_backtrace" class="anchor"></a><code><span><span class="keyword">val</span> fail_with_backtrace : <span>exn <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-backtrace">backtrace</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Future that just contains a failure and backtrace</p></div></div><div class="odoc-spec"><div class="spec value" id="val-fail_with_bt_opt" class="anchored"><a href="#val-fail_with_bt_opt" class="anchor"></a><code><span><span class="keyword">val</span> fail_with_bt_opt : <span>exn <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-backtrace">backtrace</a> option</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-error" class="anchored"><a href="#val-error" class="anchor"></a><code><span><span class="keyword">val</span> error : 
  <span>?process:string <span class="arrow">&#45;&gt;</span></span>
  <span>?kind:<span class="xref-unresolved">Imandra_util</span>.Error.kind <span class="arrow">&#45;&gt;</span></span>
  <span>loc:<span class="xref-unresolved">Imandra_util</span>.Iloc.t <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">_</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Interface to <code>Error</code>.error</p></div></div><div class="odoc-spec"><div class="spec value" id="val-errorf" class="anchored"><a href="#val-errorf" class="anchor"></a><code><span><span class="keyword">val</span> errorf : 
  <span>?process:string <span class="arrow">&#45;&gt;</span></span>
  <span>?kind:<span class="xref-unresolved">Imandra_util</span>.Error.kind <span class="arrow">&#45;&gt;</span></span>
  <span>loc:<span class="xref-unresolved">Imandra_util</span>.Iloc.t <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>( <span class="type-var">'a</span>, <span class="xref-unresolved">Stdlib</span>.Format.formatter, unit, <span><span class="type-var">'b</span> <a href="#type-t">t</a></span> )</span> <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Interface to <code>Error</code>.error</p></div></div><div class="odoc-spec"><div class="spec value" id="val-return_res" class="anchored"><a href="#val-return_res" class="anchor"></a><code><span><span class="keyword">val</span> return_res : <span><span><span>( <span class="type-var">'a</span>, <a href="#type-exn_with_bt_opt">exn_with_bt_opt</a> )</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-wait_block" class="anchored"><a href="#val-wait_block" class="anchor"></a><code><span><span class="keyword">val</span> wait_block : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Block the current thread until the future is resolved.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <span class="value">an</span> <p>exception e if the future was resolved with <code>set_exn</code> or created with <code>fail</code></p></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-wait_block_catch" class="anchored"><a href="#val-wait_block_catch" class="anchor"></a><code><span><span class="keyword">val</span> wait_block_catch : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">'a</span>, <a href="#type-exn_with_bt_opt">exn_with_bt_opt</a> )</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p>Block the current thread until the future is resolved, like <code>wait</code>. Catches exceptions into a result.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-wait_block_poll" class="anchored"><a href="#val-wait_block_poll" class="anchor"></a><code><span><span class="keyword">val</span> wait_block_poll : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Wait in an active poll, so as to still catch signals and check other things.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ignore" class="anchored"><a href="#val-ignore" class="anchor"></a><code><span><span class="keyword">val</span> ignore : <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div></details></div><div class="odoc-spec"><div class="spec module-type" id="module-type-EXECUTOR" class="anchored"><a href="#module-type-EXECUTOR" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-EXECUTOR/index.html">EXECUTOR</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-S" class="anchored"><a href="#module-type-S" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-S/index.html">S</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Make" class="anchored"><a href="#module-Make" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Make/index.html">Make</a></span><span> (<a href="Make/argument-1-E/index.html">E</a> : <a href="module-type-EXECUTOR/index.html">EXECUTOR</a>) : <a href="module-type-S/index.html">S</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-unwrap_" class="anchored"><a href="#val-unwrap_" class="anchor"></a><code><span><span class="keyword">val</span> unwrap_ : <span><span><span>( <span class="type-var">'a</span>, <a href="#type-exn_with_bt_opt">exn_with_bt_opt</a> )</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Unwrap result by raising in case of error</p></div></div></div></body></html>